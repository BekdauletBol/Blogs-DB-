<!DOCTYPE html>
<html lang="en">
<head>
    <title>Blog App</title>
    <style>
        body { font-family: sans-serif; max-width: 600px; margin: 20px auto; }
        .blog { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; border-radius: 5px; }
        form { display: flex; flex-direction: column; gap: 10px; margin-bottom: 30px; }
    </style>
</head>
<body>
<h1>Simple Blog Platform</h1>

<form id="blogForm">
    <input type="text" id="title" placeholder="Title" required>
    <textarea id="body" placeholder="Content" required></textarea>
    <input type="text" id="author" placeholder="Author (optional)">
    <button type="submit">Create Post</button>
</form>

<div id="blogsList"></div>

<script>
    const form = document.getElementById('blogForm');
    const list = document.getElementById('blogsList');

    async function fetchBlogs() {
        const res = await fetch('/blogs');
        const blogs = await res.json();
        list.innerHTML = blogs.map(b => `
                <div class="blog">
                    <h3>${b.title}</h3>
                    <p>${b.body}</p>
                    <small>By ${b.author} on ${new Date(b.createdAt).toLocaleString()}</small>
                    <button onclick="deleteBlog('${b._id}')">Delete</button>
                </div>
            `).join('');
    }

    form.onsubmit = async (e) => {
        e.preventDefault();
        const data = {
            title: document.getElementById('title').value,
            body: document.getElementById('body').value,
            author: document.getElementById('author').value || undefined
        };
        await fetch('/blogs', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });
        form.reset();
        fetchBlogs();
    };

    async function deleteBlog(id) {
        await fetch(`/blogs/${id}`, { method: 'DELETE' });
        fetchBlogs();
    }

    fetchBlogs();
</script>
</body>
</html>